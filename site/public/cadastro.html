<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- CSS Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.min.css'>
    <link rel="stylesheet" href="./css/cadastro.css">
    <link rel="stylesheet" href="./css/telaCadastroFunc.css">
    <link rel="icon" href="./assets/imgs/sobreNos.png">
    <script src="./js/perfil-validacao.js"></script>

    <title>Cadastre-se | Junte-se á nós!!!</title>
</head>

<body>

    <div class="container ">
        <!-- left-side bg-light -->
        <div class="col-md-10 main bg-body-secondary">
            <div class="col-md-6 left-side">
                <img src="./assets/svg/register.svg" alt="" class="vh-75">
                <br>

            </div><!--col-sm-6-->
            <div class="col-md-6 right-side bg-body-secondary">
                <h3 class="tilte">Você já tem uma conta?</h3>

                <!--Form with header-->
                <div class="form">
                    <div class="divisao d-flex justify-content-around">
                        <div class="divisao-column-1">
                            <div class="form-group ">
                                <label class="tilte-form" for="inputNome">Nome</label>
                                <input class="form-control  input-empresa" id="inputNome" placeholder="Ex: Thiago Serafim" required
                                onblur="validarNome()" />
                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputSenha">Senha</label>
                                <input class="form-control input-empresa" id="inputSenha" placeholder="Ex: Senha@123" type="password"
                  onblur="validarSenha()" required />
                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputCNPJ">CNPJ</label>
                                <input id="inputCNPJ" class="form-control input-lg primeiro"
                                    placeholder="Informe o CNPJ" onblur="validarCNPJ()" required>

                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputEmail">E-mail</label>
                                <input id="inputEmail" class="form-control input-lg segundo"
                                    placeholder="Digite seu E-mail" onblur="validarEmail()" required>

                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputContato">Tel.</label>
                                <input id="inputContato" class="form-control input-lg quarto"
                                    placeholder="Digite seu Tel." onblur="validarContato()" required>
                            </div>
                            <div class="form-group">
                                <label class="tilte-form" for="inputEmpresa">Empresa</label>
                                <input id="inputEmpresa" class="form-control input-lg terceiro"
                                    placeholder="Nome da Empresa" onblur="validarEmpresa()" required>
                            </div>
                            
                        </div>
                        <div class="divisao-column-1">
                            <div class="form-group ">
                                <label class="tilte-form" for="inputLogradouro">Logradouro</label>
                                <input id="inputLogradouro" class="form-control input-lg terceiro"
                                    placeholder="Rua Haddock" onblur="validarLogradouro()" required>
                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputBairro">Bairro</label>
                                <input id="inputBairro" class="form-control input-lg terceiro"
                                    placeholder="Ex: Consolação" onblur="validarBairro()" required>
                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputCEP">CEP</label>
                                <input class="form-control input-empresa" id="inputCEP" placeholder="Ex: 08150200" required
                                 onblur="validarCEP()" />
                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputNumero">Número</label>
                                <input id="inputNumero" class="form-control input-lg terceiro"
                                    placeholder=" 173 " onblur="validarNumero()" required>
                            </div>
                            <div class="form-group">
                                <label class="tilte-form" for="inputCidade">Cidade</label>
                                <input id="inputCidade" type="text" class="form-control input-lg terceiro"
                                    placeholder="Nome da Empresa" onblur="validarCidade()" required>
                            </div>
                            <div class="form-group ">
                                <label class="tilte-form" for="inputUF">UF</label>
                                <select class="form-control select-lg terceiro " id="inputUF" name="estado" onclick="validarUF()">
                                    <option value="none"></option>
                                    <option value="AC">Acre</option>
                                    <option value="AL">Alagoas</option>
                                    <option value="AP">Amapá</option>
                                    <option value="AM">Amazonas</option>
                                    <option value="BA">Bahia</option>
                                    <option value="CE">Ceará</option>
                                    <option value="DF">Distrito Federal</option>
                                    <option value="ES">Espírito Santo</option>
                                    <option value="GO">Goiás</option>
                                    <option value="MA">Maranhão</option>
                                    <option value="MT">Mato Grosso</option>
                                    <option value="MS">Mato Grosso do Sul</option>
                                    <option value="MG">Minas Gerais</option>
                                    <option value="PA">Pará</option>
                                    <option value="PB">Paraíba</option>
                                    <option value="PR">Paraná</option>
                                    <option value="PE">Pernambuco</option>
                                    <option value="PI">Piauí</option>
                                    <option value="RJ">Rio de Janeiro</option>
                                    <option value="RN">Rio Grande do Norte</option>
                                    <option value="RS">Rio Grande do Sul</option>
                                    <option value="RO">Rondônia</option>
                                    <option value="RR">Roraima</option>
                                    <option value="SC">Santa Catarina</option>
                                    <option value="SP">São Paulo</option>
                                    <option value="SE">Sergipe</option>
                                    <option value="TO">Tocantins</option>
                                    <option value="EX">Estrangeiro</option>
                                  </select>

                            </div>
                        </div>
                    </div>
                    

                    <div class="text-xs-center">
                        <button id="btn_cadastrar_empresa" class="btn btn-deep-purple" onclick="botao_registro()">
                            CADASTRAR
                          </button> 
                    </div>

                    <div class="inputBox">
                        <span class="tilte-form">Já tem conta? Faça login clicando
                            <a href="./login.html"> aqui.</a></span>
                    </div>


                </div>
                <!--/Form with header



            </div><!--col-sm-8-->

        </div><!--container-->


</body>

</html>

<!-- JavaScript Bootstrap -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
    crossorigin="anonymous"></script>
<script src="./js/funcao.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.all.min.js"></script>

<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

function cadastrar() {
  // aguardar();
  window.location.href = "login.html";
  //Recupere o valor da nova input pelo nome do id
  // Agora vá para o método fetch logo abaixo
  var nomeVar = inputNome.value;
  var cnpjVar = inputCNPJ.value;
  var emailVar = inputEmail.value;
  var senhaVar = btoa(inputSenha.value);
  var empresaNomeVar = inputEmpresa.value;
  var contatoVar = inputContato.value;
  var logradouroVar = inputLogradouro.value;
  // var cidadeVar = inputCidade.value;
  var estadoVar = inputUF.value;
  var cepVar = inputCEP.value;
  var bairroVar = inputBairro.value;

  // if (userVar == "" || senhaVar == "" || nomeVar == "" || emailVar == "") {
  //     cardErro.style.display = "block"
  //     mensagem_erro.innerHTML = "(Mensagem de erro para todos os campos em branco)";

  //     finalizarAguardar();
  //     return false;
  // }
  // else {
  //     setInterval(sumirMensagem, 5000)
  // }

  // Enviando o valor da nova input
  fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
          "Content-Type": "application/json"
      },
      body: JSON.stringify({
          // crie um atributo que recebe o valor recuperado aqui
          // Agora vá para o arquivo routes/usuario.js
          
          nomeServer: nomeVar,
          senhaServer: senhaVar,
          emailServer: emailVar,
          contatoServer: contatoVar,
          cnpjServer: cnpjVar,
          empresaNomeServer: empresaNomeVar,
          cnpjServer: cnpjVar,
          logradouroServer: logradouroVar,
          cidadeServer: cidadeVar,
          estadoServer: estadoVar,
          cepServer: cepVar,
          bairroServer: bairroVar,
          complementoVar: complementoVar,
      })
  }).then(function (resposta) {

      console.log("resposta: ", resposta);

      if (resposta.ok) {
          setTimeout(() => {
              window.location = "login.html";
          }, "2000")
          
          limparFormulario();
          // finalizarAguardar();
      } else {
        Swal.fire({
          icon: 'error',
          title: 'Oops...',
          text: 'Houve um erro ao tentar realizar o cadastro!',
        })

      }
  }).catch(function (resposta) {
      console.log(`#ERRO: ${resposta}`);
      // finalizarAguardar();
  });

  return false;
}

function validar_autenticacao_cadastro() {
  if (
    validar_nome &&
    validar_cnpj &&
    validar_email &&
    validar_senha &&
    validar_empresa &&
    validar_logradouro &&
    validar_bairro  &&
    validar_cep &&
    validar_uf &&
    validar_cidade 
    // validar_usuario &&
  ) {
    Swal.fire({
      position: 'center',
      icon: 'success',
      title: 'Seu cadastro foi realizado com sucesso!',
      showConfirmButton: false,
      timer: 2000
    })

    setInterval(() => cadastrar(), 2000);
    // document.getElementById("btnCadastrar").disabled = false;
    // window.location.href = "login.html";
  } else {
    Swal.fire({
      icon: 'error',
      title: 'Oops...',
      text: 'Autenticação inválida!',
    })
  }
}

</script>